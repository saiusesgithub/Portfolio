---
interface Props {
  title: string;
}

const { title } = Astro.props;
import TargetCursor from '../components/TargetCursor';
import Preloader from '../components/Preloader.astro';
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Brutalist Portfolio" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;800&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script>
      // Load Lucide icons with fallback CDN if primary fails (avoids 404 in some environments)
      (function() {
        var primary = 'https://cdn.jsdelivr.net/npm/lucide@0.263.1/dist/lucide.min.js';
        var fallback = 'https://unpkg.com/lucide@0.263.1/dist/lucide.min.js';
        function load(src: string) {
          var s = document.createElement('script');
          s.src = src;
          s.async = false;
          s.onload = function() { console.log('Loaded lucide from', src); };
          s.onerror = function() {
            if (src !== fallback) {
              console.warn('Failed to load lucide from', src, ' â€” trying fallback');
              load(fallback);
            } else {
              console.error('Failed to load lucide from all CDNs');
            }
          };
          document.head.appendChild(s);
        }
        if (typeof document !== 'undefined') load(primary);
      })();
    </script>
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body class="antialiased selection:bg-safety-orange selection:text-white">
    <!-- Preloader -->
    <Preloader />
    
    <!-- The Grain -->
    <div class="noise-overlay"></div>
    
    <!-- Target Cursor Effect (client-only to avoid SSR issues) -->
    <TargetCursor client:only="react" spinDuration={3.5} hideDefaultCursor={false} parallaxOn={true} hoverDuration={0.5} />
    
    <slot />
    
    <script>
      // Initialize Lucide icons after page load (safe access via window[] to avoid TS build errors)
      document.addEventListener('DOMContentLoaded', () => {
        if (typeof window !== 'undefined' && (window as any)['lucide']) {
          (window as any)['lucide'].createIcons();
        }
      });
    </script>
  </body>
</html>

<style is:global>
  :root {
    --bg-concrete: #E6E6E6;
    --text-rebar: #1A1A1A;
    --safety-orange: #FF3300;
    --beam-black: #000000;
  }
  
  body {
    background-color: var(--bg-concrete);
    color: var(--text-rebar);
    font-family: 'Inter', sans-serif;
    overflow-x: hidden;
    cursor: none !important;
  }
  
  /* Force hide cursor on all elements */
  *, *::before, *::after {
    cursor: none !important;
  }
  
  a, button, input, textarea, select {
    cursor: none !important;
  }
  
  /* The Grain - Analog Noise */
  .noise-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999;
    opacity: 0.08;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    mix-blend-mode: overlay;
  }
  
  /* Utilities */
  .border-beam {
    border: 2px solid var(--beam-black);
  }
  
  .border-beam-b {
    border-bottom: 2px solid var(--beam-black);
  }
  
  .border-beam-r {
    border-right: 2px solid var(--beam-black);
  }
  
  .border-beam-t {
    border-top: 2px solid var(--beam-black);
  }
  
  .tracking-tight-custom {
    letter-spacing: -0.04em;
  }
  
  /* Image Filters */
  .brutalist-img {
    filter: grayscale(100%) contrast(110%);
    transition: filter 0.1s linear;
  }
  
  .brutalist-img:hover {
    filter: grayscale(0%) contrast(100%);
  }
  
  /* Custom Scrollbar */
  ::-webkit-scrollbar {
    width: 12px;
    background: var(--bg-concrete);
    border-left: 2px solid black;
  }
  
  ::-webkit-scrollbar-thumb {
    background: black;
  }
  
  /* Grid Overlay Effect */
  #grid-overlay {
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    grid-template-rows: repeat(10, 1fr);
  }
  
  .grid-square {
    background: var(--safety-orange);
    width: 100%;
    height: 100%;
    border: 1px solid rgba(0, 0, 0, 0.1);
    transition: opacity 0.4s ease-out;
    cursor: crosshair;
  }
  
  .fade-out {
    opacity: 0 !important;
    pointer-events: none;
  }
</style>
