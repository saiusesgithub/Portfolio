---
import { siteData } from '../data/portfolio';
---

<section id="about" class="w-full border-beam-b grid grid-cols-1 lg:grid-cols-12 min-h-[90vh] relative">
  <!-- The 100 Orange Squares Overlay - covers entire viewport including navbar -->
  <div id="grid-overlay" class="fixed inset-0 z-[300] w-full h-full" style="pointer-events: none;"></div>
  
  <!-- Left: The Visual -->
  <div class="lg:col-span-8 border-beam-r relative overflow-hidden group">
    <div 
      class="absolute inset-0 bg-cover bg-center brutalist-img" 
      style="background-image: url('https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=2072&auto=format&fit=crop');"
    ></div>
    
    <!-- Scale Figure Interaction -->
    <div class="absolute bottom-8 right-8 bg-white border-beam p-2 font-tech text-xs z-10 hidden group-hover:block">
      DEVELOPER REF <i data-lucide="user" class="inline w-3 h-3 ml-1"></i>
    </div>

    <!-- Overlay Effect -->
    <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent pointer-events-none"></div>
  </div>

  <!-- Right: The Typography -->
  <div class="lg:col-span-4 flex flex-col justify-between bg-concrete p-6 lg:p-10 relative">
    <!-- Grid Lines Decoration -->
    <div class="absolute top-0 left-0 w-full h-[2px] bg-black"></div>
    
    <div>
      <div class="font-tech text-xs text-safety-orange mb-4 flex items-center gap-2">
        <i data-lucide="circle-dot" class="w-3 h-3"></i> {siteData.status}
      </div>
      <h1 class="text-6xl lg:text-7xl font-extrabold uppercase tracking-tight-custom leading-[0.85] mb-6">
        {siteData.tagline.split(' ').map((word) => (
          <>{word}<br /></>
        ))}
      </h1>
      <div class="w-12 h-2 bg-safety-orange mb-6"></div>
      <p class="font-medium text-lg leading-snug max-w-sm">
        {siteData.about}
      </p>
    </div>

    <div class="mt-12 lg:mt-0">
      <div class="font-tech text-[10px] mb-2 text-gray-500 uppercase">
        Location: {siteData.coordinates}
      </div>
      <a 
        href="#projects" 
        class="cursor-target group block w-full border-beam bg-transparent hover:bg-black hover:text-white transition-all duration-0 p-4 text-center uppercase font-bold tracking-wider flex justify-between items-center"
      >
        <span>View Projects</span>
        <i data-lucide="arrow-down-right" class="w-5 h-5"></i>
      </a>
    </div>
  </div>
</section>

<script is:inline>
  // Generate 100 squares (10x10 grid) for interactive reveal effect
  (function() {
    function initGridOverlay() {
      var gridContainer = document.getElementById('grid-overlay');
      
      if (!gridContainer) {
        console.warn('Grid overlay container not found');
        return;
      }
      
      // Clear any existing squares (in case of re-run)
      gridContainer.innerHTML = '';
      
      var totalSquares = 100;
      var fadedCount = 0;

      for (var i = 0; i < totalSquares; i++) {
        var square = document.createElement('div');
        square.className = 'grid-square';
        // Each square needs pointer-events so you can hover it
        square.style.pointerEvents = 'auto';
        
        // Mouse hover interaction
        square.addEventListener('mouseover', function() {
          if (!this.classList.contains('fade-out')) {
            this.classList.add('fade-out');
            // fade-out CSS sets pointer-events: none, so events pass through
            fadedCount++;
            // Once all squares are gone, remove the overlay entirely
            if (fadedCount >= totalSquares) {
              gridContainer.remove();
            }
          }
        });

        // Touch support for mobile devices
        square.addEventListener('touchstart', function() {
          if (!this.classList.contains('fade-out')) {
            this.classList.add('fade-out');
            fadedCount++;
            if (fadedCount >= totalSquares) {
              gridContainer.remove();
            }
          }
        }, { passive: true });

        gridContainer.appendChild(square);
      }
    }

    // Multiple strategies to ensure it runs
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initGridOverlay);
    } else if (document.readyState === 'interactive') {
      requestAnimationFrame(initGridOverlay);
    } else {
      initGridOverlay();
    }
  })();
</script>
