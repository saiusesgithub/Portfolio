---
const iconSlug: Record<string, string> = {
  'AWS': 'amazonwebservices', 'Google Cloud': 'googlecloud', 'Oracle Cloud': 'oracle',
  'Cloudflare': 'cloudflare', 'Docker': 'docker', 'Terraform': 'terraform',
  'GitHub Actions': 'githubactions', 'Git': 'git', 'Linux': 'linux',
  'Flask': 'flask', 'FastAPI': 'fastapi', 'MySQL': 'mysql', 'SQLite': 'sqlite',
  'Firebase': 'firebase', 'Supabase': 'supabase', 'Flutter': 'flutter',
  'Dart': 'dart', 'Python': 'python', 'C': 'c', 'R': 'r', 'Bash': 'gnubash',
  'VS Code': 'vscodium', 'Figma': 'figma', 'Notion': 'notion',
  'Jira': 'jira', 'GitHub Codespaces': 'github', 'Ubuntu': 'ubuntu',
  'Pop!_OS': 'popos', 'Kali Linux': 'kalilinux', 'Lubuntu': 'lubuntu',
  'Raspbian': 'raspberrypi', 'Ansible': 'ansible',
  'Kubernetes': 'kubernetes',
};

function getIcon(name: string) {
  const slug = iconSlug[name];
  return slug ? `https://cdn.simpleicons.org/${slug}/000000` : null;
}

interface Tech { name: string; items?: string[]; }

const skillCategories = [
  {
    id: '01', title: 'Cloud Platforms',
    description: 'Multi-cloud infrastructure design and deployment across major providers.',
    techs: [
      { name: 'AWS', items: ['EC2', 'S3', 'Lambda', 'IAM', 'VPC'] },
      { name: 'Google Cloud', items: ['Compute Engine', 'Cloud Storage'] },
      { name: 'Oracle Cloud' },
      { name: 'Cloudflare' },
    ] as Tech[],
  },
  {
    id: '02', title: 'DevOps & Automation',
    description: 'CI/CD pipelines, containerization, and infrastructure automation.',
    techs: [
      { name: 'Docker', items: ['Compose', 'Swarm'] },
      { name: 'Terraform', items: ['State Management'] },
      { name: 'GitHub Actions', items: ['Workflows', 'YAML Pipelines'] },
      { name: 'Git', items: ['Branching', 'Merging', 'Git Flow'] },
      { name: 'Linux' },
    ] as Tech[],
  },
  {
    id: '03', title: 'Backend & Databases',
    description: 'REST APIs, relational databases, and cloud-hosted backend services.',
    techs: [
      { name: 'Flask' }, { name: 'FastAPI' }, { name: 'MySQL' },
      { name: 'SQLite' },
      { name: 'Firebase', items: ['Firestore', 'Auth', 'Hosting'] },
      { name: 'Supabase' },
    ] as Tech[],
  },
  {
    id: '04', title: 'Mobile Development',
    description: 'Cross-platform mobile applications with native performance.',
    techs: [{ name: 'Flutter' }, { name: 'Dart' }] as Tech[],
  },
  {
    id: '05', title: 'Languages & Scripting',
    description: 'Multi-paradigm programming and automation scripting.',
    techs: [
      { name: 'Python' }, { name: 'C' }, { name: 'R' },
      { name: 'Bash' }, { name: 'YAML' },
    ] as Tech[],
  },
  {
    id: '06', title: 'Tools & Platforms',
    description: 'Development environments and collaboration platforms.',
    techs: [
      { name: 'VS Code' }, { name: 'Figma' }, { name: 'Notion' },
      { name: 'Jira' }, { name: 'Antigravity' }, { name: 'GitHub Codespaces' },
    ] as Tech[],
  },
  {
    id: '07', title: 'Networking & Security',
    description: 'Network protocols, encryption, and access management.',
    techs: [
      { name: 'SSH' }, { name: 'DNS' }, { name: 'SSL/TLS' },
      { name: 'IAM' }, { name: 'VPN' }, { name: 'HTTP/HTTPS' },
    ] as Tech[],
  },
  {
    id: '08', title: 'Operating Systems',
    description: 'Linux distributions and system administration.',
    techs: [
      { name: 'Ubuntu' }, { name: 'Pop!_OS' }, { name: 'Kali Linux' },
      { name: 'Linux Lite' }, { name: 'Lubuntu' }, { name: 'Raspbian' },
      { name: 'WSL' },
    ] as Tech[],
  },
];

const currentlyExploring = [
  { name: 'Kubernetes' }, { name: 'Ansible' },
] as Tech[];

// Category SVG icons (monoline technical style)
const categoryIcons: Record<string, string> = {
  '01': '<path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"/>',
  '02': '<circle cx="12" cy="12" r="3"/><path d="M12 1v2m0 18v2m-9-11h2m18 0h2m-3.3-7.7-1.4 1.4M4.7 19.3l1.4-1.4m0-11.8L4.7 4.7m14.6 14.6-1.4-1.4"/>',
  '03': '<ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/><path d="M3 12c0 1.66 4 3 9 3s9-1.34 9-3"/>',
  '04': '<rect x="5" y="2" width="14" height="20" rx="2"/><path d="M12 18h.01"/>',
  '05': '<polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/>',
  '06': '<path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>',
  '07': '<rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>',
  '08': '<rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/>',
};
---
<section id="skills" class="w-full bg-concrete border-beam-b relative pb-20">
  <!-- Warning Tape Marquee Separator right at the top -->
  <div class="w-full bg-[repeating-linear-gradient(45deg,#000,#000_10px,#ff4500_10px,#ff4500_20px)] h-4 border-b-4 border-black mb-12 lg:mb-20"></div>

  <div class="grid grid-cols-1 lg:grid-cols-12 max-w-[1400px] mx-auto px-4 lg:px-8 gap-8 lg:gap-12">

    <!-- LEFT PANEL: Sticky Heading -->
    <div class="lg:col-span-4 relative">
      <div class="lg:sticky lg:top-28 border-4 border-black bg-white p-6 lg:p-10 shadow-[12px_12px_0_0_#000] relative">
        <!-- Top Brackets & Decor -->
        <div class="absolute -top-4 -left-4 w-8 h-8 border-t-4 border-l-4 border-safety-orange"></div>
        <div class="absolute -bottom-4 -right-4 w-8 h-8 border-b-4 border-r-4 border-safety-orange"></div>
        <div class="absolute top-4 right-4 text-[10px] font-tech font-bold text-gray-400">02_SYS.DB</div>
        
        <p class="font-tech text-xs bg-black text-white px-2 py-1 inline-block uppercase tracking-widest mb-6">
          /// TECH_STACK_MODULE
        </p>
        <h2 class="text-5xl lg:text-7xl font-black uppercase tracking-tight-custom leading-[0.85] mb-6 text-black" style="text-shadow: -3px 3px 0 #ff4500;">
          CORE<br />SKILLS<span class="text-safety-orange">_</span>
        </h2>
        
        <div class="w-full h-1 bg-black mb-6"></div>
        
        <p class="text-base font-bold text-black border-l-4 border-safety-orange pl-4">
          Architecting cloud systems, automating pipelines, and building everything in between.
        </p>
        
        <!-- Decoration barcode -->
        <div class="mt-8 flex gap-1 h-6 opacity-30">
          <div class="w-1 bg-black"></div><div class="w-2 bg-black"></div><div class="w-1 bg-black"></div><div class="w-3 bg-black"></div>
          <div class="w-1 bg-black"></div><div class="w-1 bg-black"></div><div class="w-4 bg-black"></div><div class="w-2 bg-black"></div>
        </div>
      </div>
    </div>

    <!-- RIGHT PANEL: Stacked Skill Rows -->
    <div class="lg:col-span-8 flex flex-col gap-8 lg:gap-10">
      {skillCategories.map((cat, idx) => (
        <div class="group relative border-4 border-black bg-white p-6 lg:p-8 shadow-[8px_8px_0_0_#000] hover:shadow-[12px_12px_0_0_#ff4500] hover:-translate-y-1 hover:-translate-x-1 transition-all duration-300">
          
          <!-- Category Card Header ID -->
          <div class="absolute -top-5 left-6 border-4 border-black bg-safety-orange px-3 py-1 font-black text-xl lg:text-2xl text-black shadow-[4px_4px_0_0_#000] z-10 group-hover:-translate-y-1 transition-transform">
            {cat.id}
          </div>

          <!-- Top-right corner status dot -->
          <div class="absolute top-4 right-6 flex items-center gap-2">
            <span class="text-[9px] font-tech font-bold uppercase text-gray-500">SYS.MOUNTED</span>
            <div class="w-2 h-2 rounded-full bg-green-500 border border-black animate-pulse"></div>
          </div>

          <!-- Row Content -->
          <div class="mt-4 flex flex-col pt-2">
            
            <div class="flex items-center gap-4 mb-3">
               <!-- Icon Block -->
              <div class="flex items-center justify-center w-12 h-12 border-2 border-black bg-gray-100 text-black group-hover:bg-black group-hover:text-safety-orange transition-colors duration-300 shrink-0">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
                  <Fragment set:html={categoryIcons[cat.id]} />
                </svg>
              </div>

              <div class="flex-1 min-w-0">
                <h3 class="text-xl lg:text-2xl font-black uppercase tracking-tight text-black">{cat.title}</h3>
                <span class="font-tech text-[10px] text-black bg-gray-200 border border-black px-1 uppercase tracking-widest shrink-0">
                  {cat.techs.length} UNITS
                </span>
              </div>
            </div>

            <p class="text-sm font-bold text-gray-600 mb-6 border-b-2 border-dashed border-gray-300 pb-4">
              {cat.description}
            </p>

            <!-- Brutalist Tech Pills -->
            <div class="flex flex-wrap gap-2 lg:gap-3">
              {cat.techs.map((tech) => (
                <div class="tech-pill flex flex-col border-2 border-black bg-white shadow-[3px_3px_0_0_#000] hover:shadow-none hover:translate-x-[3px] hover:translate-y-[3px] transition-all duration-100 cursor-crosshair">
                  <div class="flex items-center gap-2 px-3 py-2 bg-white text-black hover:bg-black hover:text-white transition-colors duration-0">
                    {getIcon(tech.name) ? (
                      <img
                        src={getIcon(tech.name)!}
                        alt=""
                        class="w-4 h-4 icon-img transition-all duration-0"
                        loading="lazy"
                      />
                    ) : (
                      <span class="w-2 h-2 bg-safety-orange border border-black shrink-0"></span>
                    )}
                    <span class="font-bold text-xs lg:text-sm uppercase tracking-wider">{tech.name}</span>
                  </div>
                  {tech.items && (
                    <div class="px-3 py-1 border-t-2 border-black bg-gray-50 text-[9px] lg:text-[10px] uppercase font-bold text-gray-600 block w-full whitespace-normal">
                      {tech.items.join(' / ')}
                    </div>
                  )}
                </div>
              ))}
            </div>
            
          </div>
        </div>
      ))}

      <!-- CURRENTLY EXPLORING (Special Layout Card) -->
      <div class="group relative border-4 border-safety-orange bg-black p-6 lg:p-8 shadow-[8px_8px_0_0_#ff4500] hover:-translate-y-1 hover:-translate-x-1 transition-all duration-300 mt-4 overflow-hidden">
        <!-- Stripe overlay -->
        <div class="absolute inset-0 opacity-10 pointer-events-none bg-[repeating-linear-gradient(-45deg,transparent,transparent_4px,white_4px,white_8px)]"></div>
        
        <div class="absolute top-4 right-6 flex items-center gap-2 z-10">
          <span class="text-[9px] font-tech font-bold uppercase text-safety-orange animate-pulse">IN_PROGRESS</span>
        </div>

        <div class="relative z-10 flex flex-col">
          <div class="flex items-center gap-4 mb-4">
             <div class="flex items-center justify-center w-12 h-12 border-2 border-safety-orange bg-safety-orange text-black shrink-0">
              <span class="font-tech text-3xl font-black leading-none">?</span>
            </div>
            
            <div class="flex-1 min-w-0">
              <h3 class="text-xl lg:text-2xl font-black uppercase tracking-tight text-white">Currently Exploring</h3>
            </div>
          </div>
          
          <p class="text-sm font-bold text-gray-400 mb-6 border-b-2 border-dashed border-[#333] pb-4">
            R&D pipeline. Unstable builds and experimental technologies.
          </p>

          <div class="flex flex-wrap gap-2 lg:gap-3">
            {currentlyExploring.map((tech) => (
              <div class="tech-pill flex items-center gap-2 px-3 py-2 border-2 border-dashed border-safety-orange bg-black text-safety-orange hover:bg-safety-orange hover:text-black transition-colors duration-0 cursor-crosshair">
                {getIcon(tech.name) ? (
                  <img
                    src={getIcon(tech.name)!}
                    alt=""
                    class="w-4 h-4 icon-img transition-all duration-0"
                    loading="lazy"
                    style="filter: invert(41%) sepia(87%) saturate(2284%) hue-rotate(345deg) brightness(101%) contrast(105%);"
                  />
                ) : (
                  <span class="w-1.5 h-1.5 bg-safety-orange shrink-0"></span>
                )}
                <span class="font-bold text-xs lg:text-sm uppercase tracking-wider">{tech.name}</span>
              </div>
            ))}
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<style is:global>
  /* Base state: black for icons in light buttons */
  .tech-pill .icon-img {
    transition: filter 0.1s;
  }
  
  /* When hovering the primary button area, white icons */
  .tech-pill > div:hover .icon-img {
    filter: invert(1) brightness(2) !important;
  }
  
  /* Currently exploring hover to black */
  .tech-pill.border-dashed:hover .icon-img {
    filter: brightness(0) saturate(100%) !important;
  }
</style>
